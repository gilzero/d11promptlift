"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const findFileInCurrentPath_1 = __importDefault(require("../fs/findFileInCurrentPath"));
const loadJsonFile_1 = __importDefault(require("../fs/loadJsonFile"));
async function getDrupalInfo() {
    var _a, _b, _c;
    try {
        const path = (0, findFileInCurrentPath_1.default)('composer.json');
        if (!path) {
            return undefined;
        }
        const json = await (0, loadJsonFile_1.default)(path);
        if (json && ((_c = (_b = (_a = json.extra) === null || _a === void 0 ? void 0 : _a['drupal-scaffold']) === null || _b === void 0 ? void 0 : _b.locations) === null || _c === void 0 ? void 0 : _c['web-root'])) {
            const root = (0, path_1.join)((0, path_1.dirname)(path), json.extra['drupal-scaffold'].locations['web-root']);
            return {
                root,
                name: 'drupal',
                emulsifyParentDirectory: (0, path_1.join)(root, 'themes', 'custom'),
                platformMajorVersion: 9,
            };
        }
    }
    catch (_d) {
        return undefined;
    }
    return undefined;
}
exports.default = getDrupalInfo;
